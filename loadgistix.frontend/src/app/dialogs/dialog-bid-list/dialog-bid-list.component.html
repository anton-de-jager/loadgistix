<div class="fixed inset-0 sm:relative flex flex-col min-w-0 dark:bg-card dark:bg-gray-800 overflow-hidden">
    <div class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary text-on-primary">
        <div class="text-lg font-medium">{{data.title}} Bid</div>
        <button (click)="onNoClick()" mat-icon-button [tabIndex]="-1">
            <mat-icon class="text-on-primary">close</mat-icon>
        </button>
    </div>
    <mat-dialog-content
        class="flex flex-col flex-auto mat-typography bg-card dark:bg-gray-800 p-0 h-fit max-h-max sm:max-h-[65vh]">
        <div class="flex flex-auto flex-col overflow-x-auto">
            <table *ngIf="dataSource" mat-table [dataSource]="dataSource" matSort>
                <ng-container matColumnDef="cud" sticky="true">
                    <th mat-header-cell *matHeaderCellDef class="cudColumn bg-primary text-on-primary">
                        <!-- <button mat-mini-fab class="cudButton"
                        (click)="initUpsert(null)" matTooltip="Add Bid">
                        <mat-icon class="fab-icon">add</mat-icon>
                    </button> -->
                    </th>
                    <td mat-cell *matCellDef="let row">
                        <button *ngIf="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed')" mat-mini-fab
                            class="cudButton"
                            (click)="initUpsert(row, 1)"
                            matTooltip="View Details">
                            <mat-icon class="fab-icon">search</mat-icon>
                        </button>
                        <button *ngIf="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed')" mat-mini-fab class="cudButton" (click)="initDelete(row.id)" matTooltip="Remove Bid">
                            <mat-icon class="fab-icon">delete</mat-icon>
                        </button>
                    </td>
                </ng-container>
                <ng-container matColumnDef="userDescription">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="userDescription">User
                        </p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.userDescription}} </td>
                </ng-container>
                <ng-container matColumnDef="userCompany">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="userCompany">Company
                        </p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        bidRow.userCompany <br>
                        <!-- <mat-star-rating [rating]="row.reviewAverageLoad" [starCount]="5" [color]="starColorP"
                            (ratingUpdated)="onRatingChanged($event)"></mat-star-rating> -->
                    </td>
                </ng-container>
                <ng-container matColumnDef="loadDescription">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="loadDescription">Load
                            Description</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{bidRow.description}} </td>
                </ng-container>
                <ng-container matColumnDef="vehicleDescription">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="vehicleDescription">
                            Vehicle</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.vehicleDescription}} </td>
                </ng-container>
                <ng-container matColumnDef="driverDescription">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="driverDescription">
                            Driver
                        </p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.driverDescription}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="reviewAverageDriver">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="reviewAverageDriver">Driver
                            Rating</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        <mat-star-rating [rating]="row.reviewAverageDriver" [starCount]="5" [color]="starColorP"
                            class="w-fit" (ratingUpdated)="onRatingChanged($event)"></mat-star-rating>
                    </td>
                </ng-container>
                <ng-container matColumnDef="price">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="price">Price</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        R{{row.price | number:'1.0-0'}} </td>
                </ng-container>
                <ng-container matColumnDef="dateOut">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="dateOut">Departure
                            Date</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.dateOut |
                        date:'yyyy-MM-dd'}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="dateIn">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="dateIn">Delivery
                            Date</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.dateIn |
                        date:'yyyy-MM-dd'}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="status">
                    <th mat-header-cell class='table-header-column bg-primary text-on-primary' *matHeaderCellDef>
                        <p class='table-header-column bg-primary text-on-primary' mat-sort-header="status">Status</p>
                    </th>
                    <td mat-cell *matCellDef="let row" class="selectable"
                        (click)="(row.status==='Pending'||row.status==='Open'||row.status==='Bid(s) Placed') ? initUpsert(row, 1) : ''">
                        {{row.status}} </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
    </mat-dialog-content>
    <div
        class="flex items-end flex-row items-center border-t bg-primary text-on-primary bg-card dark:bg-gray-800 dark:text-primary justify-between pl-4 pr-4">


    </div>
    <mat-dialog-actions class="flex items-end flex-row items-center justify-between bg-gray-200 dark:bg-gray-600">
        <mat-paginator [pageSize]="10" [hidePageSize]="true" [disabled]="loading"
            class="bg-transparent dark:text-primary"></mat-paginator>
    </mat-dialog-actions>
</div>

<ng-template #loadingTemplate>
    <div class="loading-template"></div>
</ng-template>
